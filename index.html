<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RSEBL Market Tracker</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
</head>
<body>

  <header>
    <div class="header-inner">
      <div class="logo">
        <span class="logo-flag">ðŸ‡§ðŸ‡¹</span>
        <div>
          <span class="logo-title">RSEBL Tracker</span>
          <span class="logo-sub">Royal Securities Exchange of Bhutan</span>
        </div>
      </div>
      <div class="header-stats">
        <div class="stat-chip">
          <span class="stat-label">BSI</span>
          <span class="stat-value" id="bsi-value">â€”</span>
        </div>
        <div class="stat-chip">
          <span class="stat-label">Securities</span>
          <span class="stat-value" id="total-count">â€”</span>
        </div>
        <div class="stat-chip">
          <span class="stat-label">Updated</span>
          <span class="stat-value" id="last-updated">â€”</span>
        </div>
      </div>
    </div>
  </header>

  <main>

    <!-- Sector summary bar -->
    <section class="sector-bar" id="sector-bar"></section>

    <!-- Tab navigation -->
    <nav class="tabs">
      <button class="tab active" data-tab="market">Market</button>
      <button class="tab" data-tab="news">News & Announcements</button>
    </nav>

    <!-- MARKET TAB -->
    <div class="tab-content active" id="tab-market">
      <div class="table-controls">
        <input type="text" id="search-input" placeholder="Search symbol or company..." />
        <select id="sector-filter">
          <option value="">All Sectors</option>
        </select>
        <span id="row-count"></span>
      </div>
      <div class="table-wrap">
        <table id="stocks-table">
          <thead>
            <tr>
              <th data-col="symbol" class="sortable">Symbol <span class="sort-icon">â‡…</span></th>
              <th data-col="name" class="sortable">Company <span class="sort-icon">â‡…</span></th>
              <th data-col="price" class="sortable num">Price (Nu.) <span class="sort-icon">â‡…</span></th>
              <th data-col="change_pct" class="sortable num">Change % <span class="sort-icon">â‡…</span></th>
              <th data-col="pe_ratio" class="sortable num">P/E <span class="sort-icon">â‡…</span></th>
              <th data-col="volume" class="sortable num">Volume <span class="sort-icon">â‡…</span></th>
              <th data-col="market_cap" class="sortable num">Mkt Cap <span class="sort-icon">â‡…</span></th>
            </tr>
          </thead>
          <tbody id="stocks-body">
            <tr><td colspan="7" class="loading">Loading market data...</td></tr>
          </tbody>
        </table>
      </div>

      <!-- Price chart panel (shown when a stock row is clicked) -->
      <div class="chart-panel hidden" id="chart-panel">
        <div class="chart-header">
          <div>
            <span class="chart-symbol" id="chart-symbol"></span>
            <span class="chart-name" id="chart-name"></span>
          </div>
          <div class="chart-range-btns">
            <button class="range-btn active" data-months="6">6M</button>
            <button class="range-btn" data-months="12">1Y</button>
            <button class="range-btn" data-months="24">2Y</button>
            <button class="range-btn" data-months="0">All</button>
          </div>
          <button class="chart-close" id="chart-close">âœ•</button>
        </div>
        <div class="chart-wrap">
          <canvas id="price-chart"></canvas>
        </div>
        <p class="chart-note" id="chart-note"></p>
      </div>
    </div>

    <!-- NEWS TAB -->
    <div class="tab-content" id="tab-news">
      <div id="news-list" class="news-list">
        <p class="loading">Loading news...</p>
      </div>
    </div>

  </main>

  <footer>
    <p>Data scraped daily from <a href="https://rsebl.org.bt" target="_blank" rel="noopener">rsebl.org.bt</a>. Not financial advice. History available from April 2020.</p>
  </footer>

  <script src="app.js"></script>
</body>
</html>
